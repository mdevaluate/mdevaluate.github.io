

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Evaluation of static properties &mdash; mdevaluate dev-17.11 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="_static/gallery.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="mdevaluate dev-17.11 documentation" href="index.html"/>
        <link rel="up" title="User Guide" href="guide.html"/>
        <link rel="next" title="Evaluation of dynamic properties" href="dynamic-evaluation.html"/>
        <link rel="prev" title="Loading of simulation data" href="loading.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> mdevaluate
          

          
          </a>

          
            
            
              <div class="version">
                dev-17.11
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="general-hints.html">General Hints for Python Programming</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="guide.html">User Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="loading.html">Loading of simulation data</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Evaluation of static properties</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#slicing-of-the-trajectory">Slicing of the trajectory</a></li>
<li class="toctree-l3"><a class="reference internal" href="#calculating-distributions">Calculating distributions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#advanced-evaluations">Advanced evaluations</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="dynamic-evaluation.html">Evaluation of dynamic properties</a></li>
<li class="toctree-l2"><a class="reference internal" href="special-topics.html">Special Topics</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="gallery/index.html">Example Gallery</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="modules.html">Reference Guide</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">mdevaluate</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="guide.html">User Guide</a> &raquo;</li>
        
      <li>Evaluation of static properties</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/static-evaluation.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <a href="https://github.com/mdevaluate/mdevaluate"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://camo.githubusercontent.com/e7bbb0521b397edbd5fe43e7f760759336b5e05f/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f677265656e5f3030373230302e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_green_007200.png"></a><div class="section" id="evaluation-of-static-properties">
<h1>Evaluation of static properties<a class="headerlink" href="#evaluation-of-static-properties" title="Permalink to this headline">¶</a></h1>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>All examples in this section assume, that the packages has been imported and a trajectory was loaded:</p>
<div class="last highlight-python3"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">mdevaluate.distribution</span> <span class="k">as</span> <span class="nn">dist</span>

<span class="n">coords</span> <span class="o">=</span> <span class="n">mdevaluate</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;/path/to/simulation&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Static properties of the system, like density distribution or pair correlation function,
can be evaluated with the <a class="reference internal" href="mdevaluate.html#module-mdevaluate.distribution" title="mdevaluate.distribution"><code class="xref py py-mod docutils literal"><span class="pre">mdevaluate.distribution</span></code></a> module.
It provides the function <a class="reference internal" href="mdevaluate.html#mdevaluate.distribution.time_average" title="mdevaluate.distribution.time_average"><code class="xref py py-func docutils literal"><span class="pre">mdevaluate.distribution.time_average()</span></code></a>
that computes the average of a property over the whole trajectory.
An example call of this function is:</p>
<div class="highlight-python3"><div class="highlight"><pre><span></span><span class="n">tetra</span> <span class="o">=</span> <span class="n">dist</span><span class="o">.</span><span class="n">time_average</span><span class="p">(</span><span class="n">dist</span><span class="o">.</span><span class="n">tetrahedral_order</span><span class="p">,</span> <span class="n">coords</span><span class="p">)</span>
</pre></div>
</div>
<p>This will calculate the average of the tetrahedral order parameter for each atom.
The first argument of <code class="xref py py-func docutils literal"><span class="pre">time_average()</span></code> is a function that takes one argument.
It will be called for each frame in the trajectory and the output of this function
is than averaged over all these frames.</p>
<div class="section" id="slicing-of-the-trajectory">
<h2>Slicing of the trajectory<a class="headerlink" href="#slicing-of-the-trajectory" title="Permalink to this headline">¶</a></h2>
<p>In most cases averaging each frame of the trajectory is not necessary,
since the conformation of the atoms doesn’t change significantly between two frames.
Hence it is sufficient to skip some frames without suffering significant statistics.
The exact amount of frames which can be skipped before the statistics suffer depends strongly
on the calculated property, therefore it has to be chosen manually.
For this purpose the Coordinates objects can be sliced like any python list:</p>
<div class="highlight-python3"><div class="highlight"><pre><span></span><span class="n">tetra</span> <span class="o">=</span> <span class="n">dist</span><span class="o">.</span><span class="n">time_average</span><span class="p">(</span><span class="n">dist</span><span class="o">.</span><span class="n">tetrahedral_order</span><span class="p">,</span> <span class="n">coords</span><span class="p">[</span><span class="mi">1000</span><span class="p">::</span><span class="mi">50</span><span class="p">])</span>
</pre></div>
</div>
<p>This makes it possible to skip a number of frames at the start (or end) and with every step.
The above call would start with frame 1000 of the trajectory and evaluate each 50th frame until the end.
Since the number of frames read and evaluated is reduced by about a factor of 50, the computational cost will decrease accordingly.</p>
</div>
<div class="section" id="calculating-distributions">
<h2>Calculating distributions<a class="headerlink" href="#calculating-distributions" title="Permalink to this headline">¶</a></h2>
<p>In many cases the static distributions of a property is of interest.
For example, the tetrahedral order parameter is often wanted as a distribution.
This can too be calculated with <code class="docutils literal"><span class="pre">time_average</span></code> but the bins of the distribution have to be specified:</p>
<div class="highlight-python3"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">functools</span> <span class="k">import</span> <span class="n">partial</span>
<span class="n">func</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">dist</span><span class="o">.</span><span class="n">tetrahedral_order_distribution</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">401</span><span class="p">)</span>
<span class="n">tetra_dist</span> <span class="o">=</span> <span class="n">dist</span><span class="o">.</span><span class="n">time_average</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">coords</span><span class="p">)</span>
</pre></div>
</div>
<p>The bins (which are ultimately used with the function <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.histogram.html#numpy.histogram" title="(in NumPy v1.13)"><code class="xref py py-func docutils literal"><span class="pre">numpy.histogram()</span></code></a>) are specified
by partially evaluating the evaluation function with <a class="reference external" href="https://docs.python.org/3/library/functools.html#functools.partial" title="(in Python v3.6)"><code class="xref py py-func docutils literal"><span class="pre">functools.partial()</span></code></a>.
See the documentation of <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.histogram.html#numpy.histogram" title="(in NumPy v1.13)"><code class="xref py py-func docutils literal"><span class="pre">numpy.histogram()</span></code></a> for details on bin specification.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.histogram.html#numpy.histogram" title="(in NumPy v1.13)"><code class="xref py py-func docutils literal"><span class="pre">numpy.histogram()</span></code></a> is used with <code class="xref py py-func docutils literal"><span class="pre">time_average()</span></code> the bins have to be given explicitly.
When not specified, the bins will be chosen automatically for each call of <code class="docutils literal"><span class="pre">histogram</span></code> leading to
different bins for each frame, hence an incorrect average.</p>
</div>
</div>
<div class="section" id="advanced-evaluations">
<h2>Advanced evaluations<a class="headerlink" href="#advanced-evaluations" title="Permalink to this headline">¶</a></h2>
<p>The function that will be evaluated by <code class="docutils literal"><span class="pre">time_average</span></code> can return numpy arrays of arbitrary shape.
It is for example possible to calculate the distribution of a property for several subsets of the system at once:</p>
<div class="highlight-python3"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">subset_tetra</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">bins</span><span class="p">):</span>
    <span class="n">tetra</span> <span class="o">=</span> <span class="n">dist</span><span class="o">.</span><span class="n">tetrahedral_order</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">tetra</span><span class="p">[</span><span class="mi">0</span><span class="p">::</span><span class="mi">2</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">),</span>
                  <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">tetra</span><span class="p">[</span><span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">),])</span>

<span class="n">func</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">subset</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">201</span><span class="p">))</span>
<span class="n">tetra_subdist</span> <span class="o">=</span> <span class="n">dist</span><span class="o">.</span><span class="n">time_average</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">coords</span><span class="p">)</span>
</pre></div>
</div>
<p>In this example the tetrahedral order parameter is first calculated for each atom of the system.
Then the distribution is calculated for two subsets, containing atoms (0, 2, 4, 6, …) and (1, 3, 5, 7, …).</p>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="dynamic-evaluation.html" class="btn btn-neutral float-right" title="Evaluation of dynamic properties" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="loading.html" class="btn btn-neutral" title="Loading of simulation data" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, Niels Müller.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'dev-17.11',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>